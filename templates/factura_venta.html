<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Factura {{ factura.numero_comprobante }}</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        font-size: 9px; /* más pequeño para ticketera */
        color: #333;
        width: 200px; /* ancho aproximado de ticketera 80mm */
        margin: 0 auto;
      }
      h1 {
        font-size: 12px;
        text-align: center;
        margin-bottom: 3px;
      }
      p {
        margin: 1px 0;
      }
      .fechas,
      .cliente {
        margin-bottom: 3px;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 3px;
      }
      th,
      td {
        text-align: left;
        padding: 1px 0;
      }
      th {
        border-bottom: 1px dashed #333; /* línea sutil */
      }
      td.left {
        text-align: left;
      }
      .totales {
        margin-top: 3px;
        width: 100%;
      }
      .totales td {
        padding: 1px 0;
      }
      .totales .label {
        text-align: left;
        font-weight: bold;
      }
      .totales .value {
        text-align: right;
      }
      .footer {
        text-align: center;
        margin-top: 5px;
        font-size: 8px;
        color: #555;
      }
    </style>
  </head>
  <body>
    <h1>Factura {{ factura.numero_comprobante }}</h1>

    <div class="fechas">
      <p>Fecha: {{ venta.fecha_creacion|date:"d/m/Y H:i" }}</p>
      <p>
        Cliente: {% if venta.cliente %} {{ venta.cliente.nombre }} {% else %}
        Cliente no registrado {% endif %}
      </p>
    </div>

    <table>
      <thead>
        <tr>
          <th>Producto</th>
          <th>Cant.</th>
          <th>Precio</th>
          <th>Desc.</th>
          <th>Subtotal</th>
        </tr>
      </thead>
      <tbody>
        {% for detalle in detalles %}
        <tr>
          <td class="left">{{ detalle.inventario.producto.nombre }}</td>
          <td>{{ detalle.cantidad|floatformat:2 }}</td>
          <td>{{ detalle.precio_unitario|floatformat:2 }}</td>
          <td>{{ detalle.descuento_unitario|floatformat:2 }}</td>
          <td>{{ detalle.sub_total|floatformat:2 }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <table class="totales">
      <tr>
        <td class="value">
          Descuento Global: {{ venta.descuento|floatformat:2 }}
        </td>
      </tr>
      <tr>
        <td class="value">
          Total a Pagar: {{ venta.total_venta|floatformat:2 }}
        </td>
      </tr>
    </table>

    <div class="footer">
      <p>Gracias por su compra</p>
      <p>* No válido para crédito fiscal *</p>
    </div>
  </body>
</html>
